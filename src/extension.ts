// The module 'vscode' contains the VS Code extensibility API
// Import the module and reference it with the alias vscode in your code below
import * as vscode from "vscode";

const motions = [
  "data:image/png;base64,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",
];

let lastDecoration: vscode.TextEditorDecorationType;

// This method is called when your extension is activated
// Your extension is activated the very first time the command is executed
export function activate() {
  // The command has been defined in the package.json file
  // Now provide the implementation of the command with registerCommand
  // The commandId parameter must match the command field in package.json
  vscode.workspace.onDidChangeTextDocument(changeTextDocument);
  vscode.window.onDidChangeTextEditorVisibleRanges(changeTextDocument);
}

function changeTextDocument() {
  const editor = vscode.window.activeTextEditor;
  if (!editor) {
    return;
  }
  const firstVisibleRange = editor.visibleRanges.find(
    (range) => !range.isEmpty
  );

  if (!firstVisibleRange) {
    return;
  }

  const range = new vscode.Range(
    firstVisibleRange.start,
    firstVisibleRange.start
  );

  const decoration = vscode.window.createTextEditorDecorationType({
    after: {
      contentText: ``,
      margin: "0.5em 0 0 0",
      textDecoration: `none; 
      width:50px; 
      height:50px; 
      background-image: url("${motions[0]}");
      background-size: contain;
      background-repeat: no-repeat;
      position: absolute; 
      right: 5vw; 
      top: 50%; 
      transform: translateY(-50%);
      z-index: 1;
      pointer-events: none;
      font-size:50px;`,
    },
  });
  lastDecoration?.dispose();
  lastDecoration = decoration;
  editor.setDecorations(decoration, [range]);
}

// This method is called when your extension is deactivated
export function deactivate() {}
